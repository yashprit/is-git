import fs from'fs';import path from'path';import{K,add,chain,curry,isString,keys,length,map,pipe,propOr,split}from'f-utility';import Future from'fluture';function unwrapExports(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,'default')?a['default']:a}function createCommonjsModule(a,b){return b={exports:{}},a(b,b.exports),b.exports}var ini=createCommonjsModule(function(a,b){function c(a,b){var e=[],g='';'string'==typeof b?b={section:b,whitespace:!1}:(b=b||{},b.whitespace=!0===b.whitespace);var i=b.whitespace?' = ':'=';return Object.keys(a).forEach(function(b){var c=a[b];c&&Array.isArray(c)?c.forEach(function(a){g+=f(b+'[]')+i+f(a)+'\n'}):c&&'object'==typeof c?e.push(b):g+=f(b)+i+f(c)+h}),b.section&&g.length&&(g='['+f(b.section)+']'+h+g),e.forEach(function(e){var f=d(e).join('\\.'),i=(b.section?b.section+'.':'')+f,j=c(a[e],{section:i,whitespace:b.whitespace});g.length&&j.length&&(g+=h),g+=j}),g}function d(a){return a.replace(/\1/g,'\x02LITERAL\\1LITERAL\x02').replace(/\\\./g,'\x01').split(/\./).map(function(a){return a.replace(/\1/g,'\\.').replace(/\2LITERAL\\1LITERAL\2/g,'\x01')})}function e(a){return'"'===a.charAt(0)&&'"'===a.slice(-1)||'\''===a.charAt(0)&&'\''===a.slice(-1)}function f(a){return'string'!=typeof a||a.match(/[=\r\n]/)||a.match(/^\[/)||1<a.length&&e(a)||a!==a.trim()?JSON.stringify(a):a.replace(/;/g,'\\;').replace(/#/g,'\\#')}function g(a){if(a=(a||'').trim(),e(a)){'\''===a.charAt(0)&&(a=a.substr(1,a.length-2));try{a=JSON.parse(a)}catch(a){}}else{for(var b,c=!1,d='',f=0,g=a.length;f<g;f++)if(b=a.charAt(f),c)d+=-1==='\\;#'.indexOf(b)?'\\'+b:b,c=!1;else if(-1!==';#'.indexOf(b))break;else'\\'===b?c=!0:d+=b;return c&&(d+='\\'),d}return a}b.parse=b.decode=function(a){var b={},c=b,e=null,f=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i,h=a.split(/[\r\n]+/g),e=null;return h.forEach(function(a){if(a&&!a.match(/^\s*[;#]/)){var d=a.match(f);if(d){if(void 0!==d[1])return e=g(d[1]),void(c=b[e]=b[e]||{});var h=g(d[2]),i=!d[3]||g(d[4]||'');'true'===i||'false'===i||'null'===i?i=JSON.parse(i):void 0,2<h.length&&'[]'===h.slice(-2)&&(h=h.substring(0,h.length-2),c[h]?!Array.isArray(c[h])&&(c[h]=[c[h]]):c[h]=[]),Array.isArray(c[h])?c[h].push(i):c[h]=i}}}),Object.keys(b).filter(function(a){if(!b[a]||'object'!=typeof b[a]||Array.isArray(b[a]))return!1;var c=d(a),e=b,f=c.pop(),g=f.replace(/\\\./g,'.');return(c.forEach(function(a){e[a]&&'object'==typeof e[a]||(e[a]={}),e=e[a]}),e!==b||g!==f)&&(e[g]=b[a],!0)}).forEach(function(a){delete b[a]}),b},b.stringify=b.encode=c,b.safe=f,b.unsafe=g;var h='win32'===process.platform?'\r\n':'\n'});var parseGitConfig=git;function git(a,b){if('function'==typeof a&&(b=a,a=null),'function'!=typeof b)throw new TypeError('parse-git-config async expects a callback function.');read(resolve(a),function(a,c){return a?void b(a):void b(null,ini.parse(c.toString()))})}git.sync=function(a){var b=resolve(a);return fs.existsSync(b)?ini.parse(fs.readFileSync(b,'utf8')):null};function read(a,b){try{fs.readFile(a,function(a,c){return a?b(a):void b(null,c)})}catch(a){b(a)}}function resolve(a){return path.join(a||process.cwd(),'.git/config')}var pathExists=createCommonjsModule(function(a){'use strict';a.exports=function(a){return new Promise(function(b){fs.access(a,function(a){b(!a)})})},a.exports.sync=function(a){try{return fs.accessSync(a),!0}catch(a){return!1}}}),PLACEHOLDER='\uD83C\uDF5B',$=PLACEHOLDER,innerpipe=function(a){return function(b){for(var c=a[0],d=a.slice(1),e=c(b),f=0;f<d.length;f++)e=d[f](e);return e}};function pipe$1(){for(var e=arguments,a=arguments.length,b=Array(a),c=0;c<a;++c)b[c]=e[c];return innerpipe(b)}function compose(){for(var e=arguments,a=arguments.length,b=Array(a),c=0;c<a;++c)b[c]=e[c];return innerpipe(b.reverse())}var version='0.6.0',K$1=function(b){return function(){return b}},I=function(b){return b},bindInternal3=function(c,d){return function(e,f,a){return c.call(d,e,f,a)}},some$1=function(g,a,b){var c,d=g.length,e=void 0===b?a:bindInternal3(a,b);for(c=0;c<d;c++)if(e(g[c],c,g))return!0;return!1},curry$1=function(i){if('function'!=typeof i)throw new TypeError('Expected to be given a function to curry!');var j=function(b){return b===PLACEHOLDER};return function b(){for(var a=arguments,c=arguments.length,k=Array(c),d=0;d<c;++d)k[d]=a[d];var e=some$1(k,j)?function(b){for(var a=b.length;!j(b[a]);)a--;return a}(k):k.length;return e>=i.length?i.apply(this,k):function(){for(var c=arguments,a=arguments.length,d=Array(a),e=0;e<a;++e)d[e]=c[e];return b.apply(this,k.map(function(b){return j(b)&&d[0]?d.shift():b}).concat(d))}}},curryify=function(i){if('function'!=typeof i)throw new TypeError('Expected to be given a function to test placeholders!');return function(a){if('function'!=typeof a)throw new TypeError('Expected to be given a function to curry!');return function j(){for(var b=arguments,c=arguments.length,k=Array(c),d=0;d<c;++d)k[d]=b[d];var e=some$1(k,i)?function(a){for(var b=a.length;!i(a[b]);)b--;return b}(k):k.length;return e>=a.length?a.apply(this,k):function(){for(var a=arguments,b=arguments.length,c=Array(b),d=0;d<b;++d)c[d]=a[d];return j.apply(this,k.map(function(a){return i(a)&&c[0]?c.shift():a}).concat(c))}}}},remapArray=curry$1(function(e,a){var f=Array.from(a);return f.length?f.map(function(a,b){return e.includes(b)?f[e[b]]:a}):f}),remap=curry$1(function(e,a){var b=remapArray(e),c=curry$1(a);return function(){var d=b(Array.from(arguments));return c.apply(null,d)}}),prop=curry$1(function(c,a){return a[c]}),_assign=Object.assign,_keys=Object.keys,keys$1=_keys,assign=_assign,merge=curry$1(function(b,c){return assign({},b,c)}),propLength=prop('length'),objectLength=pipe$1(keys$1,propLength),length$1=function(b){return'object'==typeof b?objectLength(b):propLength(b)},delegatee=curry$1(function(d,a,b){return b[d](a)}),filter=delegatee('filter'),flipIncludes=curry$1(function(c,a){return c.includes(a)}),matchingKeys=curry$1(function(c,a){return filter(flipIncludes(c),keys$1(a))}),matchingKeyCount=curry$1(function(c,a){return pipe$1(matchingKeys(c),length$1)(a)}),curryObjectByCondition=curry$1(function(f,a,b){return function c(d){return f(a,d)?b(d):pipe$1(merge(d),c)}}),expectKArgs=function(c,a){return matchingKeyCount(c,a)>=length$1(c)},curryObjectK=curryObjectByCondition(expectKArgs),expectNArgs=function(c,a){return length$1(a)>=c},curryObjectN=curryObjectByCondition(expectNArgs),curryObjectKN=curryObjectByCondition(function(e,a){var b=e.n,c=e.k;return expectKArgs(c,a)||expectNArgs(b,a)}),katsuCurry=Object.freeze({$:$,PLACEHOLDER:PLACEHOLDER,compose:compose,pipe:pipe$1,version:version,K:K$1,I:I,curry:curry$1,curryify:curryify,remap:remap,remapArray:remapArray,curryObjectK:curryObjectK,curryObjectN:curryObjectN,curryObjectKN:curryObjectKN}),katsuCurry$1=katsuCurry,entrust=createCommonjsModule(function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var f=katsuCurry$1.curry(function(c,a){return a[c]()}),g=katsuCurry$1.curry(function(d,b,c){return c[d](b)}),h=katsuCurry$1.curry(function(e,c,d,a){return a[e](c,d)}),i=katsuCurry$1.curry(function(f,d,e,a,b){return b[f](d,e,a)}),j=katsuCurry$1.curry(function(g,e,f,a,b,c){return c[g](e,f,a,b)}),k=katsuCurry$1.curry(function(h,f,g,a,b,c,d){return d[h](f,g,a,b,c)}),l=katsuCurry$1.curry(function(i,g,h,a,b,c,d,e){return e[i](g,h,a,b,c,d)}),m=katsuCurry$1.curry(function(j,h,i,a,b,c,d,e,f){return f[j](h,i,a,b,c,d,e)}),n=katsuCurry$1.curry(function(k,i,j,a,b,c,d,e,f,g){return g[k](i,j,a,b,c,d,e,f)}),o=katsuCurry$1.curry(function(l,j,k,a,b,c,d,e,f,g,h){return h[l](j,k,a,b,c,d,e,f,g)}),p=katsuCurry$1.curry(function(m,k,l,a,b,c,d,e,f,g,h,i){return i[m](k,l,a,b,c,d,e,f,g,h)}),d=katsuCurry$1.curry(function(q,a,b,c){var d=[a].concat(b,[c]);return[f,g,h,i,j,k,l,m,n,o,p][q].apply(null,d)}),c=katsuCurry$1.curry(function(f,b,c,e){if(f!==c.length)throw new Error(b+' expects total args ('+c.length+') to equal the given arity ('+f+')');return d(f,b,c,e)});b.e0=f,b.e1=g,b.e2=h,b.e3=i,b.e4=j,b.e5=k,b.e6=l,b.e7=m,b.e8=n,b.e9=o,b.e10=p,b.eN=d,b.eD=c});unwrapExports(entrust);var entrust_1=entrust.e0,entrust_2=entrust.e1,checkPathExists=Future.encaseP(pathExists),parser=function(a){return new Future(function(b,c){return parseGitConfig({cwd:a,path:'.git/config'},function(a,d){return a?b(a):c(d)})})},pop=entrust_1('pop'),mapRej=entrust_2('mapRej'),getFolderName=pipe(split('\\'),pop),forceTrailingSlash=function(a){return /\/$/.test(a)?a:a+'/'},parseConfig=curry(function(a,b){return b?parser(a):Future.of(!1)}),checkForCore=pipe(propOr({},'core'),keys,length,function(a){return 0<a}),inAllBadCasesReturnFalse=pipe(K,mapRej)(!1),isGit=function(a){return isString(a)?pipe(getFolderName,forceTrailingSlash,add('.git/config'),checkPathExists,chain(parseConfig(a)),map(checkForCore),inAllBadCasesReturnFalse)(a):Future.reject(new TypeError('Expected to be given string to check as filepath.'))};export default isGit;
